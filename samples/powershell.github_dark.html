<pre class="athl w-full overflow-auto rounded-lg p-8 font-mono text-sm antialiased leading-6" style="color: #e6edf3; background-color: #30363d;"><code class="language-powershell" translate="no" tabindex="0"><span class="line" data-line="1"><span style="color: #8b949e;"># Single line comments start with a number symbol.</span>
</span><span class="line" data-line="2">
</span><span class="line" data-line="3"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="4"><span style="color: #8b949e;">  Multi-line comments</span>
</span><span class="line" data-line="5"><span style="color: #8b949e;">  like so</span>
</span><span class="line" data-line="6"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="7">
</span><span class="line" data-line="8">
</span><span class="line" data-line="9"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="10"><span style="color: #8b949e;">## 1. Primitive Datatypes and Operators</span>
</span><span class="line" data-line="11"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="12">
</span><span class="line" data-line="13"><span style="color: #8b949e;"># Numbers</span>
</span><span class="line" data-line="14"><span style="color: #79c0ff;">3</span> <span style="color: #8b949e;"># =&gt; 3</span>
</span><span class="line" data-line="15">
</span><span class="line" data-line="16"><span style="color: #8b949e;"># Math</span>
</span><span class="line" data-line="17"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">+</span> <span style="color: #79c0ff;">1</span>   <span style="color: #8b949e;"># =&gt; 2</span>
</span><span class="line" data-line="18"><span style="color: #79c0ff;">8</span> <span style="color: #79c0ff;">-</span> <span style="color: #79c0ff;">1</span>   <span style="color: #8b949e;"># =&gt; 7</span>
</span><span class="line" data-line="19"><span style="color: #79c0ff;">10</span> <span style="color: #79c0ff;">*</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; 20</span>
</span><span class="line" data-line="20"><span style="color: #79c0ff;">35</span> <span style="color: #79c0ff;">/</span> <span style="color: #79c0ff;">5</span>  <span style="color: #8b949e;"># =&gt; 7.0</span>
</span><span class="line" data-line="21">
</span><span class="line" data-line="22"><span style="color: #8b949e;"># Powershell uses banker&#39;s rounding,</span>
</span><span class="line" data-line="23"><span style="color: #8b949e;"># meaning [int]1.5 would round to 2 but so would [int]2.5</span>
</span><span class="line" data-line="24"><span style="color: #8b949e;"># Division always returns a float. </span>
</span><span class="line" data-line="25"><span style="color: #8b949e;"># You must cast result to [int] to round.</span>
</span><span class="line" data-line="26"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">5</span> <span style="color: #79c0ff;">/</span> <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">3</span>       <span style="color: #8b949e;"># =&gt; 1.66666666666667</span>
</span><span class="line" data-line="27"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">5</span> <span style="color: #79c0ff;">/</span> <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">3</span>      <span style="color: #8b949e;"># =&gt; -1.66666666666667</span>
</span><span class="line" data-line="28"><span style="color: #79c0ff;">5.0</span> <span style="color: #79c0ff;">/</span> <span style="color: #79c0ff;">3.0</span>   <span style="color: #8b949e;"># =&gt; 1.66666666666667</span>
</span><span class="line" data-line="29"><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">5.0</span> <span style="color: #79c0ff;">/</span> <span style="color: #79c0ff;">3.0</span>  <span style="color: #8b949e;"># =&gt; -1.66666666666667</span>
</span><span class="line" data-line="30"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$result</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">5</span> <span style="color: #79c0ff;">/</span> <span style="color: #79c0ff;">3</span> 
</span><span class="line" data-line="31"><span style="color: #e6edf3;">$result</span> <span style="color: #8b949e;"># =&gt; 2</span>
</span><span class="line" data-line="32">
</span><span class="line" data-line="33"><span style="color: #8b949e;"># Modulo operation</span>
</span><span class="line" data-line="34"><span style="color: #79c0ff;">7</span> <span style="color: #79c0ff;">%</span> <span style="color: #79c0ff;">3</span>  <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="35">
</span><span class="line" data-line="36"><span style="color: #8b949e;"># Exponentiation requires longform or the built-in [Math] class.</span>
</span><span class="line" data-line="37"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">Math</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #d2a8ff;">Pow</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># =&gt; 8</span>
</span><span class="line" data-line="38">
</span><span class="line" data-line="39"><span style="color: #8b949e;"># Enforce order of operations with parentheses.</span>
</span><span class="line" data-line="40"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">+</span> <span style="color: #79c0ff;">3</span> <span style="color: #79c0ff;">*</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; 7</span>
</span><span class="line" data-line="41"><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">+</span> <span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span> <span style="color: #79c0ff;">*</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; 8</span>
</span><span class="line" data-line="42">
</span><span class="line" data-line="43"><span style="color: #8b949e;"># Boolean values are primitives (Note: the $)</span>
</span><span class="line" data-line="44"><span style="color: #e6edf3;">$True</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="45"><span style="color: #e6edf3;">$False</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="46">
</span><span class="line" data-line="47"><span style="color: #8b949e;"># negate with !</span>
</span><span class="line" data-line="48"><span style="color: #79c0ff;">!</span><span style="color: #e6edf3;">$True</span>   <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="49"><span style="color: #79c0ff;">!</span><span style="color: #e6edf3;">$False</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="50">
</span><span class="line" data-line="51"><span style="color: #8b949e;"># Boolean Operators</span>
</span><span class="line" data-line="52"><span style="color: #8b949e;"># Note &quot;-and&quot; and &quot;-or&quot; usage</span>
</span><span class="line" data-line="53"><span style="color: #e6edf3;">$True</span> <span style="color: #79c0ff;">-and</span> <span style="color: #e6edf3;">$False</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="54"><span style="color: #e6edf3;">$False</span> <span style="color: #79c0ff;">-or</span> <span style="color: #e6edf3;">$True</span>   <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="55">
</span><span class="line" data-line="56"><span style="color: #8b949e;"># True and False are actually 1 and 0 but only support limited arithmetic.</span>
</span><span class="line" data-line="57"><span style="color: #8b949e;"># However, casting the bool to int resolves this.</span>
</span><span class="line" data-line="58"><span style="color: #e6edf3;">$True</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">$True</span> <span style="color: #8b949e;"># =&gt; 2</span>
</span><span class="line" data-line="59"><span style="color: #e6edf3;">$True</span> <span style="color: #79c0ff;">*</span> <span style="color: #79c0ff;">8</span>    <span style="color: #8b949e;"># =&gt; &#39;[System.Boolean] * [System.Int32]&#39; is undefined</span>
</span><span class="line" data-line="60"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$True</span> <span style="color: #79c0ff;">*</span> <span style="color: #79c0ff;">8</span> <span style="color: #8b949e;"># =&gt; 8</span>
</span><span class="line" data-line="61"><span style="color: #e6edf3;">$False</span> <span style="color: #79c0ff;">-</span> <span style="color: #79c0ff;">5</span>   <span style="color: #8b949e;"># =&gt; -5</span>
</span><span class="line" data-line="62">
</span><span class="line" data-line="63"><span style="color: #8b949e;"># Comparison operators look at the numerical value of True and False.</span>
</span><span class="line" data-line="64"><span style="color: #79c0ff;">0</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #e6edf3;">$False</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="65"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #e6edf3;">$True</span>   <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="66"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #e6edf3;">$True</span>   <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="67"><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">5</span> <span style="color: #79c0ff;">-ne</span> <span style="color: #e6edf3;">$False</span> <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="68">
</span><span class="line" data-line="69"><span style="color: #8b949e;"># Using boolean logical operators on ints casts to booleans for evaluation.</span>
</span><span class="line" data-line="70"><span style="color: #8b949e;"># but their non-cast value is returned</span>
</span><span class="line" data-line="71"><span style="color: #8b949e;"># Don&#39;t mix up with bool(ints) and bitwise -band/-bor</span>
</span><span class="line" data-line="72"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">bool</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">)</span>     <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="73"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">bool</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">)</span>     <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="74"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">bool</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">)</span>    <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="75"><span style="color: #79c0ff;">0</span> <span style="color: #79c0ff;">-band</span> <span style="color: #79c0ff;">2</span>     <span style="color: #8b949e;"># =&gt; 0</span>
</span><span class="line" data-line="76"><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">5</span> <span style="color: #79c0ff;">-bor</span> <span style="color: #79c0ff;">0</span>     <span style="color: #8b949e;"># =&gt; -5</span>
</span><span class="line" data-line="77">
</span><span class="line" data-line="78"><span style="color: #8b949e;"># Equality is -eq (equals)</span>
</span><span class="line" data-line="79"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #79c0ff;">1</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="80"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #79c0ff;">1</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="81">
</span><span class="line" data-line="82"><span style="color: #8b949e;"># Inequality is -ne (notequals)</span>
</span><span class="line" data-line="83"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-ne</span> <span style="color: #79c0ff;">1</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="84"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-ne</span> <span style="color: #79c0ff;">1</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="85">
</span><span class="line" data-line="86"><span style="color: #8b949e;"># More comparisons</span>
</span><span class="line" data-line="87"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">10</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="88"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-gt</span> <span style="color: #79c0ff;">10</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="89"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-le</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="90"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-ge</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="91">
</span><span class="line" data-line="92"><span style="color: #8b949e;"># Seeing whether a value is in a range</span>
</span><span class="line" data-line="93"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-and</span> <span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">3</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="94"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">3</span> <span style="color: #79c0ff;">-and</span> <span style="color: #79c0ff;">3</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">2</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="95">
</span><span class="line" data-line="96"><span style="color: #8b949e;"># (-is vs. -eq) -is checks if two objects are the same type.</span>
</span><span class="line" data-line="97"><span style="color: #8b949e;"># -eq checks if the objects have the same values, but sometimes doesn&#39;t work</span>
</span><span class="line" data-line="98"><span style="color: #8b949e;"># as expected.</span>
</span><span class="line" data-line="99"><span style="color: #8b949e;"># Note: we called &#39;[Math]&#39; from .NET previously without the preceeding</span>
</span><span class="line" data-line="100"><span style="color: #8b949e;"># namespaces. We can do the same with [Collections.ArrayList] if preferred.</span>
</span><span class="line" data-line="101"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>ArrayList</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$a</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># Point a at a new list</span>
</span><span class="line" data-line="102"><span style="color: #e6edf3;">$a</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="103"><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$a</span>                                 <span style="color: #8b949e;"># =&gt; Point b at what a is pointing to</span>
</span><span class="line" data-line="104"><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;">-is</span> <span style="color: #e6edf3;">$a</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">GetType</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span>                     <span style="color: #8b949e;"># =&gt; True, a and b equal same type</span>
</span><span class="line" data-line="105"><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #e6edf3;">$a</span>                               <span style="color: #8b949e;"># =&gt; None! See below</span>
</span><span class="line" data-line="106"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>Hashtable</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span><span style="color: #e6edf3;">&rbrace;</span>  <span style="color: #8b949e;"># =&gt; Point b at a new hash table</span>
</span><span class="line" data-line="107"><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span><span style="color: #79c0ff;"><span style="color: #a5d6ff;">&#39;one&#39;</span></span> <span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">1</span> 
</span><span class="line" data-line="108">       <span style="color: #79c0ff;"><span style="color: #a5d6ff;">&#39;two&#39;</span></span> <span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="109"><span style="color: #e6edf3;">$b</span> <span style="color: #79c0ff;">-is</span> <span style="color: #e6edf3;">$a</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">GetType</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span>                     <span style="color: #8b949e;"># =&gt; False, a and b types not equal</span>
</span><span class="line" data-line="110">
</span><span class="line" data-line="111"><span style="color: #8b949e;"># Strings are created with &quot; or &#39; but &quot; is required for string interpolation</span>
</span><span class="line" data-line="112"><span style="color: #a5d6ff;">&quot;This is a string.&quot;</span>
</span><span class="line" data-line="113"><span style="color: #a5d6ff;">&#39;This is also a string.&#39;</span>
</span><span class="line" data-line="114">
</span><span class="line" data-line="115"><span style="color: #8b949e;"># Strings can be added too! But try not to do this.</span>
</span><span class="line" data-line="116"><span style="color: #a5d6ff;">&quot;Hello &quot;</span> <span style="color: #79c0ff;">+</span> <span style="color: #a5d6ff;">&quot;world!&quot;</span>  <span style="color: #8b949e;"># =&gt; &quot;Hello world!&quot;</span>
</span><span class="line" data-line="117">
</span><span class="line" data-line="118"><span style="color: #8b949e;"># A string can be treated like a list of characters</span>
</span><span class="line" data-line="119"><span style="color: #a5d6ff;">&quot;Hello world!&quot;</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># =&gt; &#39;H&#39;</span>
</span><span class="line" data-line="120">
</span><span class="line" data-line="121"><span style="color: #8b949e;"># You can find the length of a string</span>
</span><span class="line" data-line="122"><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;This is a string&quot;</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Length</span>  <span style="color: #8b949e;"># =&gt; 16</span>
</span><span class="line" data-line="123">
</span><span class="line" data-line="124"><span style="color: #8b949e;"># You can also format using f-strings or formatted string literals.</span>
</span><span class="line" data-line="125"><span style="color: #e6edf3;">$name</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;Steve&quot;</span>
</span><span class="line" data-line="126"><span style="color: #e6edf3;">$age</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">22</span>
</span><span class="line" data-line="127"><span style="color: #a5d6ff;">&quot;He said his name is <span style="color: #e6edf3;">$name</span>.&quot;</span> 
</span><span class="line" data-line="128"><span style="color: #8b949e;"># =&gt; &quot;He said his name is Steve&quot;</span>
</span><span class="line" data-line="129"><span style="color: #a5d6ff;">&quot;&lbrace;0&rbrace; said he is &lbrace;1&rbrace; years old.&quot;</span> -f <span style="color: #e6edf3;">$name</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">$age</span> 
</span><span class="line" data-line="130"><span style="color: #8b949e;"># =&gt; &quot;Steve said he is 22 years old&quot;</span>
</span><span class="line" data-line="131"><span style="color: #a5d6ff;">&quot;<span style="color: #e6edf3;">$name</span>&#39;s name is $(<span style="color: #e6edf3;">$name</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Length</span><span style="color: #e6edf3;">)</span> characters long.&quot;</span> 
</span><span class="line" data-line="132"><span style="color: #8b949e;"># =&gt; &quot;Steve&#39;s name is 5 characters long.&quot;</span>
</span><span class="line" data-line="133">
</span><span class="line" data-line="134"><span style="color: #8b949e;"># Strings can be compared with -eq, but are case insensitive. We can</span>
</span><span class="line" data-line="135"><span style="color: #8b949e;"># force with -ceq or -ieq.</span>
</span><span class="line" data-line="136"><span style="color: #a5d6ff;">&quot;ab&quot;</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #a5d6ff;">&quot;ab&quot;</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="137"><span style="color: #a5d6ff;">&quot;ab&quot;</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #a5d6ff;">&quot;AB&quot;</span>  <span style="color: #8b949e;"># =&gt; True!</span>
</span><span class="line" data-line="138"><span style="color: #a5d6ff;">&quot;ab&quot;</span> <span style="color: #79c0ff;">-ceq</span> <span style="color: #a5d6ff;">&quot;AB&quot;</span>  <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="139"><span style="color: #a5d6ff;">&quot;ab&quot;</span> <span style="color: #79c0ff;">-ieq</span> <span style="color: #a5d6ff;">&quot;AB&quot;</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="140">
</span><span class="line" data-line="141"><span style="color: #8b949e;"># Escape Characters in Powershell</span>
</span><span class="line" data-line="142"><span style="color: #8b949e;"># Many languages use the &#39;\&#39;, but Windows uses this character for </span>
</span><span class="line" data-line="143"><span style="color: #8b949e;"># file paths. Powershell thus uses &#39;`&#39; to escape characters</span>
</span><span class="line" data-line="144"><span style="color: #8b949e;"># Take caution when working with files, as &#39;`&#39; is a</span>
</span><span class="line" data-line="145"><span style="color: #8b949e;"># valid character in NTFS filenames.</span>
</span><span class="line" data-line="146"><span style="color: #a5d6ff;">&quot;Showing`nEscape Chars&quot;</span> <span style="color: #8b949e;"># =&gt; new line between Showing and Escape</span>
</span><span class="line" data-line="147"><span style="color: #a5d6ff;">&quot;Making`tTables`tWith`tTabs&quot;</span> <span style="color: #8b949e;"># =&gt; Format things with tabs</span>
</span><span class="line" data-line="148">
</span><span class="line" data-line="149"><span style="color: #8b949e;"># Negate pound sign to prevent comment</span>
</span><span class="line" data-line="150"><span style="color: #8b949e;"># Note that the function of &#39;#&#39; is removed, but &#39;#&#39; is still present</span>
</span><span class="line" data-line="151">`#Get<span style="color: #79c0ff;">-Process</span><span style="color: #8b949e;"> # =&gt; Fail: not a recognized cmdlet</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="152"><span style="color: #8b949e;"></span>
</span><span class="line" data-line="153"><span style="color: #8b949e;"># $null is not an object</span>
</span><span class="line" data-line="154"><span style="color: #79c0ff;">$null</span>  <span style="color: #8b949e;"># =&gt; None</span>
</span><span class="line" data-line="155">
</span><span class="line" data-line="156"><span style="color: #8b949e;"># $null, 0, and empty strings and arrays all evaluate to False.</span>
</span><span class="line" data-line="157"><span style="color: #8b949e;"># All other values are True</span>
</span><span class="line" data-line="158"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">Test-Value</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$value</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="159">  <span style="color: #ff7b72;">if</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$value</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="160">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39;True&#39;</span>
</span><span class="line" data-line="161">  <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="162">  <span style="color: #ff7b72;">else</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="163">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39;False&#39;</span>
</span><span class="line" data-line="164">  <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="165"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="166">
</span><span class="line" data-line="167"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">$null</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="168"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">     </span><span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="169"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;&quot;</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">    </span><span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="170"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">[</span><span style="color: #ffa657;"></span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">      </span><span style="color: #8b949e;"># =&gt; True </span>
</span><span class="line" data-line="171"><span style="color: #8b949e;"># *[] calls .NET class; creates &#39;[]&#39; string when passed to function</span>
</span><span class="line" data-line="172"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">&lbrace;</span><span style="color: #e6edf3;"></span><span style="color: #e6edf3;"></span><span style="color: #e6edf3;">&rbrace;</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">    </span><span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="173"><span style="color: #d2a8ff;">Test-Value</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">     </span><span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="174">
</span><span class="line" data-line="175">
</span><span class="line" data-line="176"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="177"><span style="color: #8b949e;">## 2. Variables and Collections</span>
</span><span class="line" data-line="178"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="179">
</span><span class="line" data-line="180"><span style="color: #8b949e;"># Powershell uses the &quot;Write-Output&quot; function to print</span>
</span><span class="line" data-line="181"><span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;I&#39;m Posh. Nice to meet you!&quot;</span><span style="color: #e6edf3;">  </span><span style="color: #8b949e;"># =&gt; I&#39;m Posh. Nice to meet you!</span>
</span><span class="line" data-line="182">
</span><span class="line" data-line="183"><span style="color: #8b949e;"># Simple way to get input data from console</span>
</span><span class="line" data-line="184"><span style="color: #e6edf3;">$userInput</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #d2a8ff;">Read-Host</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;Enter some data: &quot;</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># Returns the data as a string</span>
</span><span class="line" data-line="185">
</span><span class="line" data-line="186"><span style="color: #8b949e;"># There are no declarations, only assignments.</span>
</span><span class="line" data-line="187"><span style="color: #8b949e;"># Convention is to use camelCase or PascalCase, whatever your team uses.</span>
</span><span class="line" data-line="188"><span style="color: #e6edf3;">$someVariable</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">5</span>
</span><span class="line" data-line="189"><span style="color: #e6edf3;">$someVariable</span>  <span style="color: #8b949e;"># =&gt; 5</span>
</span><span class="line" data-line="190">
</span><span class="line" data-line="191"><span style="color: #8b949e;"># Accessing a previously unassigned variable does not throw exception.</span>
</span><span class="line" data-line="192"><span style="color: #8b949e;"># The value is $null by default</span>
</span><span class="line" data-line="193">
</span><span class="line" data-line="194"><span style="color: #8b949e;"># Ternary Operators exist in Powershell 7 and up</span>
</span><span class="line" data-line="195"><span style="color: #79c0ff;">0</span> ? &#39;yes&#39; : &#39;no&#39;<span style="color: #8b949e;">  # =&gt; no</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="196"><span style="color: #8b949e;"></span>
</span><span class="line" data-line="197"><span style="color: #8b949e;"></span>
</span><span class="line" data-line="198"><span style="color: #8b949e;"># The default array object in Powershell is an fixed length array.</span>
</span><span class="line" data-line="199"><span style="color: #e6edf3;">$defaultArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;thing&quot;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&quot;thing2&quot;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&quot;thing3&quot;</span>
</span><span class="line" data-line="200"><span style="color: #8b949e;"># you can add objects with &#39;+=&#39;, but cannot remove objects.</span>
</span><span class="line" data-line="201"><span style="color: #e6edf3;">$defaultArray</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;thing4&quot;</span><span style="color: #e6edf3;">)</span> <span style="color: #8b949e;"># =&gt; Exception &quot;Collection was of a fixed size.&quot;</span>
</span><span class="line" data-line="202"><span style="color: #8b949e;"># To have a more workable array, you&#39;ll want the .NET [ArrayList] class</span>
</span><span class="line" data-line="203"><span style="color: #8b949e;"># It is also worth noting that ArrayLists are significantly faster</span>
</span><span class="line" data-line="204">
</span><span class="line" data-line="205"><span style="color: #8b949e;"># ArrayLists store sequences</span>
</span><span class="line" data-line="206"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>ArrayList</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$array</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="207"><span style="color: #8b949e;"># You can start with a prefilled ArrayList</span>
</span><span class="line" data-line="208"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>ArrayList</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$otherArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #79c0ff;">5</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">7</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">8</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="209">
</span><span class="line" data-line="210"><span style="color: #8b949e;"># Add to the end of a list with &#39;Add&#39; (Note: produces output, append to $null)</span>
</span><span class="line" data-line="211"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>    <span style="color: #8b949e;"># $array is now [1]</span>
</span><span class="line" data-line="212"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>    <span style="color: #8b949e;"># $array is now [1, 2]</span>
</span><span class="line" data-line="213"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>    <span style="color: #8b949e;"># $array is now [1, 2, 4]</span>
</span><span class="line" data-line="214"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>    <span style="color: #8b949e;"># $array is now [1, 2, 4, 3]</span>
</span><span class="line" data-line="215"><span style="color: #8b949e;"># Remove from end with index of count of objects-1; array index starts at 0</span>
</span><span class="line" data-line="216"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">RemoveAt</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Count</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">)</span> <span style="color: #8b949e;"># =&gt; 3 and array is now [1, 2, 4]</span>
</span><span class="line" data-line="217"><span style="color: #8b949e;"># Let&#39;s put it back</span>
</span><span class="line" data-line="218"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>   <span style="color: #8b949e;"># array is now [1, 2, 4, 3] again.</span>
</span><span class="line" data-line="219">
</span><span class="line" data-line="220"><span style="color: #8b949e;"># Access a list like you would any array</span>
</span><span class="line" data-line="221"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">]</span>   <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="222"><span style="color: #8b949e;"># Look at the last element</span>
</span><span class="line" data-line="223"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># =&gt; 3</span>
</span><span class="line" data-line="224"><span style="color: #8b949e;"># Looking out of bounds returns nothing</span>
</span><span class="line" data-line="225"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># blank line returned</span>
</span><span class="line" data-line="226">
</span><span class="line" data-line="227"><span style="color: #8b949e;"># Remove elements from a array</span>
</span><span class="line" data-line="228"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Remove</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># $array is now [1, 2, 4]</span>
</span><span class="line" data-line="229">
</span><span class="line" data-line="230"><span style="color: #8b949e;"># Insert at index an element </span>
</span><span class="line" data-line="231"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Insert</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># $array is now [1, 2, 3, 4]</span>
</span><span class="line" data-line="232">
</span><span class="line" data-line="233"><span style="color: #8b949e;"># Get the index of the first item found matching the argument</span>
</span><span class="line" data-line="234"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">IndexOf</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="235"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">IndexOf</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># Returns -1 as &quot;outside array&quot; </span>
</span><span class="line" data-line="236">
</span><span class="line" data-line="237"><span style="color: #8b949e;"># You can add arrays</span>
</span><span class="line" data-line="238"><span style="color: #8b949e;"># Note: values for $array and for $otherArray are not modified.</span>
</span><span class="line" data-line="239"><span style="color: #e6edf3;">$array</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">$otherArray</span>  <span style="color: #8b949e;"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8]</span>
</span><span class="line" data-line="240">
</span><span class="line" data-line="241"><span style="color: #8b949e;"># Concatenate arrays with &quot;AddRange()&quot;</span>
</span><span class="line" data-line="242"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">AddRange</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$otherArray</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># Now $array is [1, 2, 3, 4, 5, 6, 7, 8]</span>
</span><span class="line" data-line="243">
</span><span class="line" data-line="244"><span style="color: #8b949e;"># Check for existence in a array with &quot;in&quot;</span>
</span><span class="line" data-line="245"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-in</span> <span style="color: #e6edf3;">$array</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="246">
</span><span class="line" data-line="247"><span style="color: #8b949e;"># Examine length with &quot;Count&quot; (Note: &quot;Length&quot; on arrayList = each items length)</span>
</span><span class="line" data-line="248"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Count</span>  <span style="color: #8b949e;"># =&gt; 8</span>
</span><span class="line" data-line="249">
</span><span class="line" data-line="250"><span style="color: #8b949e;"># You can look at ranges with slice syntax.</span>
</span><span class="line" data-line="251"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">5</span><span style="color: #e6edf3;">]</span>     <span style="color: #8b949e;"># Return selected index  =&gt; [2, 4, 6]</span>
</span><span class="line" data-line="252"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">1</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">]</span>      <span style="color: #8b949e;"># Return from index 1 to 3 =&gt; [2, 3, 4]</span>
</span><span class="line" data-line="253"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">3</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">]</span>    <span style="color: #8b949e;"># Return from last 3 to last 1 =&gt; [6, 7, 8]</span>
</span><span class="line" data-line="254"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">]</span>    <span style="color: #8b949e;"># Return from last 1 to last 3 =&gt; [8, 7, 6]</span>
</span><span class="line" data-line="255"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">2</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">]</span>     <span style="color: #8b949e;"># Return from index 2 to last (NOT as most expect) =&gt; [3, 2, 1, 8]</span>
</span><span class="line" data-line="256"><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">2</span><span style="color: #79c0ff;">+</span><span style="color: #79c0ff;">4</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># Return multiple ranges with the + =&gt; [1, 3, 5, 6, 7]</span>
</span><span class="line" data-line="257">
</span><span class="line" data-line="258"><span style="color: #8b949e;"># -eq doesn&#39;t compare array but extract the matching elements</span>
</span><span class="line" data-line="259"><span style="color: #e6edf3;">$array</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">1</span>
</span><span class="line" data-line="260"><span style="color: #e6edf3;">$array</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #79c0ff;">1</span>          <span style="color: #8b949e;"># =&gt; 1,1,1</span>
</span><span class="line" data-line="261"><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Count</span>  <span style="color: #8b949e;"># =&gt; 3</span>
</span><span class="line" data-line="262">
</span><span class="line" data-line="263"><span style="color: #8b949e;"># Tuples are like arrays but are immutable.</span>
</span><span class="line" data-line="264"><span style="color: #8b949e;"># To use Tuples in powershell, you must use the .NET tuple class.</span>
</span><span class="line" data-line="265"><span style="color: #e6edf3;">$tuple</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">System<span style="color: #e6edf3;">.</span>Tuple</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #d2a8ff;">Create</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="266"><span style="color: #e6edf3;">$tuple</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Item</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">)</span>      <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="267"><span style="color: #e6edf3;">$tuple</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Item</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">)</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">3</span>  <span style="color: #8b949e;"># Raises a TypeError</span>
</span><span class="line" data-line="268">
</span><span class="line" data-line="269"><span style="color: #8b949e;"># You can do some of the array methods on tuples, but they are limited.</span>
</span><span class="line" data-line="270"><span style="color: #e6edf3;">$tuple</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Length</span>       <span style="color: #8b949e;"># =&gt; 3</span>
</span><span class="line" data-line="271"><span style="color: #e6edf3;">$tuple</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">5</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># =&gt; Exception</span>
</span><span class="line" data-line="272"><span style="color: #e6edf3;">$tuple</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">0</span><span style="color: #79c0ff;">..</span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">]</span>        <span style="color: #8b949e;"># =&gt; $null (in powershell 5)    =&gt; [1, 2, 3] (in powershell 7)</span>
</span><span class="line" data-line="273"><span style="color: #79c0ff;">2</span> <span style="color: #79c0ff;">-in</span> <span style="color: #e6edf3;">$tuple</span>        <span style="color: #8b949e;"># =&gt; False</span>
</span><span class="line" data-line="274">
</span><span class="line" data-line="275">
</span><span class="line" data-line="276"><span style="color: #8b949e;"># Hashtables store mappings from keys to values, similar to (but distinct from) Dictionaries.</span>
</span><span class="line" data-line="277"><span style="color: #8b949e;"># Hashtables do not hold entry order as arrays do. </span>
</span><span class="line" data-line="278"><span style="color: #e6edf3;">$emptyHash</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="279"><span style="color: #8b949e;"># Here is a prefilled hashtable</span>
</span><span class="line" data-line="280"><span style="color: #e6edf3;">$filledHash</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span><span style="color: #79c0ff;"><span style="color: #a5d6ff;">&quot;one&quot;</span></span><span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">1</span> 
</span><span class="line" data-line="281">                <span style="color: #79c0ff;"><span style="color: #a5d6ff;">&quot;two&quot;</span></span><span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">2</span> 
</span><span class="line" data-line="282">                <span style="color: #79c0ff;"><span style="color: #a5d6ff;">&quot;three&quot;</span></span><span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">3</span><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="283">
</span><span class="line" data-line="284"><span style="color: #8b949e;"># Look up values with []</span>
</span><span class="line" data-line="285"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">[</span><span style="color: #a5d6ff;">&quot;one&quot;</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="286">
</span><span class="line" data-line="287"><span style="color: #8b949e;"># Get all keys as an iterable with &quot;.Keys&quot;.</span>
</span><span class="line" data-line="288"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Keys</span>  <span style="color: #8b949e;"># =&gt; [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span>
</span><span class="line" data-line="289">
</span><span class="line" data-line="290"><span style="color: #8b949e;"># Get all values as an iterable with &quot;.Values&quot;.</span>
</span><span class="line" data-line="291"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Values</span>  <span style="color: #8b949e;"># =&gt; [1, 2, 3]</span>
</span><span class="line" data-line="292">
</span><span class="line" data-line="293"><span style="color: #8b949e;"># Check for existence of keys or values in a hash with &quot;-in&quot;</span>
</span><span class="line" data-line="294"><span style="color: #a5d6ff;">&quot;one&quot;</span> <span style="color: #79c0ff;">-in</span> <span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Keys</span>  <span style="color: #8b949e;"># =&gt; True</span>
</span><span class="line" data-line="295"><span style="color: #79c0ff;">1</span> <span style="color: #79c0ff;">-in</span> <span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Values</span>    <span style="color: #8b949e;"># =&gt; False (in powershell 5)    =&gt; True (in powershell 7)</span>
</span><span class="line" data-line="296">
</span><span class="line" data-line="297"><span style="color: #8b949e;"># Looking up a non-existing key returns $null</span>
</span><span class="line" data-line="298"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">[</span><span style="color: #a5d6ff;">&quot;four&quot;</span><span style="color: #e6edf3;">]</span>  <span style="color: #8b949e;"># $null</span>
</span><span class="line" data-line="299">
</span><span class="line" data-line="300"><span style="color: #8b949e;"># Adding to a hashtable</span>
</span><span class="line" data-line="301"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;five&quot;</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">5</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># $filledHash[&quot;five&quot;] is set to 5</span>
</span><span class="line" data-line="302"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;five&quot;</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">6</span><span style="color: #e6edf3;">)</span>  <span style="color: #8b949e;"># exception &quot;Item with key &quot;five&quot; has already been added&quot;</span>
</span><span class="line" data-line="303"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">[</span><span style="color: #a5d6ff;">&quot;four&quot;</span><span style="color: #e6edf3;">]</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">4</span>    <span style="color: #8b949e;"># $filledHash[&quot;four&quot;] is set to 4, running again does nothing</span>
</span><span class="line" data-line="304">
</span><span class="line" data-line="305"><span style="color: #8b949e;"># Remove keys from a hashtable</span>
</span><span class="line" data-line="306"><span style="color: #e6edf3;">$filledHash</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Remove</span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;one&quot;</span><span style="color: #e6edf3;">)</span> <span style="color: #8b949e;"># Removes the key &quot;one&quot; from filled hashtable</span>
</span><span class="line" data-line="307">
</span><span class="line" data-line="308">
</span><span class="line" data-line="309"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="310"><span style="color: #8b949e;">## 3. Control Flow and Iterables</span>
</span><span class="line" data-line="311"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="312">
</span><span class="line" data-line="313"><span style="color: #8b949e;"># Let&#39;s just make a variable</span>
</span><span class="line" data-line="314"><span style="color: #e6edf3;">$someVar</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">5</span>
</span><span class="line" data-line="315">
</span><span class="line" data-line="316"><span style="color: #8b949e;"># Here is an if statement.</span>
</span><span class="line" data-line="317"><span style="color: #8b949e;"># This prints &quot;$someVar is smaller than 10&quot;</span>
</span><span class="line" data-line="318"><span style="color: #ff7b72;">if</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$someVar</span> <span style="color: #79c0ff;">-gt</span> <span style="color: #79c0ff;">10</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="319">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #e6edf3;">$someVar</span> is bigger than 10.&quot;</span>
</span><span class="line" data-line="320"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="321"><span style="color: #ff7b72;">elseif</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$someVar</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">10</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>    <span style="color: #8b949e;"># This elseif clause is optional.</span>
</span><span class="line" data-line="322">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #e6edf3;">$someVar</span> is smaller than 10.&quot;</span>
</span><span class="line" data-line="323"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="324"><span style="color: #ff7b72;">else</span> <span style="color: #e6edf3;">&lbrace;</span>                        <span style="color: #8b949e;"># This is optional too.</span>
</span><span class="line" data-line="325">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #e6edf3;">$someVar</span> is indeed 10.&quot;</span>
</span><span class="line" data-line="326"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="327">
</span><span class="line" data-line="328">
</span><span class="line" data-line="329"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="330"><span style="color: #8b949e;">Foreach loops iterate over arrays</span>
</span><span class="line" data-line="331"><span style="color: #8b949e;">prints:</span>
</span><span class="line" data-line="332"><span style="color: #8b949e;">    dog is a mammal</span>
</span><span class="line" data-line="333"><span style="color: #8b949e;">    cat is a mammal</span>
</span><span class="line" data-line="334"><span style="color: #8b949e;">    mouse is a mammal</span>
</span><span class="line" data-line="335"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="336"><span style="color: #ff7b72;">foreach</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$animal</span> <span style="color: #ff7b72;">in</span> <span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&quot;dog&quot;</span><span style="color: #e6edf3;">,</span> <span style="color: #a5d6ff;">&quot;cat&quot;</span><span style="color: #e6edf3;">,</span> <span style="color: #a5d6ff;">&quot;mouse&quot;</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="337">    <span style="color: #8b949e;"># You can use -f to interpolate formatted strings</span>
</span><span class="line" data-line="338">    <span style="color: #a5d6ff;">&quot;&lbrace;0&rbrace; is a mammal&quot;</span> -f <span style="color: #e6edf3;">$animal</span>
</span><span class="line" data-line="339"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="340">
</span><span class="line" data-line="341"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="342"><span style="color: #8b949e;">For loops iterate over arrays and you can specify indices</span>
</span><span class="line" data-line="343"><span style="color: #8b949e;">prints:</span>
</span><span class="line" data-line="344"><span style="color: #8b949e;">   0 a</span>
</span><span class="line" data-line="345"><span style="color: #8b949e;">   1 b</span>
</span><span class="line" data-line="346"><span style="color: #8b949e;">   2 c</span>
</span><span class="line" data-line="347"><span style="color: #8b949e;">   3 d</span>
</span><span class="line" data-line="348"><span style="color: #8b949e;">   4 e</span>
</span><span class="line" data-line="349"><span style="color: #8b949e;">   5 f</span>
</span><span class="line" data-line="350"><span style="color: #8b949e;">   6 g</span>
</span><span class="line" data-line="351"><span style="color: #8b949e;">   7 h</span>
</span><span class="line" data-line="352"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="353"><span style="color: #e6edf3;">$letters</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&#39;a&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;b&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;c&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;d&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;e&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;f&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;g&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;h&#39;</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="354"><span style="color: #ff7b72;">for</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$i</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">;</span> <span style="color: #e6edf3;">$i</span> <span style="color: #79c0ff;">-le</span> <span style="color: #e6edf3;">$letters</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Count</span><span style="color: #79c0ff;">-</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">;</span> <span style="color: #79c0ff;"><span style="color: #e6edf3;">$i</span>++</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="355">    <span style="color: #d2a8ff;">Write-Host</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">$i</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">$letters</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$i</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="356"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="357">
</span><span class="line" data-line="358"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="359"><span style="color: #8b949e;">While loops go until a condition is no longer met.</span>
</span><span class="line" data-line="360"><span style="color: #8b949e;">prints:</span>
</span><span class="line" data-line="361"><span style="color: #8b949e;">    0</span>
</span><span class="line" data-line="362"><span style="color: #8b949e;">    1</span>
</span><span class="line" data-line="363"><span style="color: #8b949e;">    2</span>
</span><span class="line" data-line="364"><span style="color: #8b949e;">    3</span>
</span><span class="line" data-line="365"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="366"><span style="color: #e6edf3;">$x</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">0</span>
</span><span class="line" data-line="367"><span style="color: #ff7b72;">while</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$x</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #79c0ff;">4</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="368">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">$x</span>
</span><span class="line" data-line="369">    <span style="color: #e6edf3;">$x</span> <span style="color: #79c0ff;">+=</span> <span style="color: #79c0ff;">1</span>  <span style="color: #8b949e;"># Shorthand for x = x + 1</span>
</span><span class="line" data-line="370"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="371">
</span><span class="line" data-line="372"><span style="color: #8b949e;"># Switch statements are more powerful compared to most languages</span>
</span><span class="line" data-line="373"><span style="color: #e6edf3;">$val</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;20&quot;</span>
</span><span class="line" data-line="374"><span style="color: #ff7b72;">switch</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$val</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="375">  <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #79c0ff;">$_</span> <span style="color: #79c0ff;">-eq</span> <span style="color: #79c0ff;">42</span> <span style="color: #e6edf3;">&rbrace;</span>           <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;The answer equals 42&quot;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #ff7b72;">break</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="376">  <span style="color: #a5d6ff;">&#39;20&#39;</span>                    <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;Exactly 20&quot;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #ff7b72;">break</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="377">  <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #79c0ff;">$_</span> <span style="color: #79c0ff;">-like</span> <span style="color: #a5d6ff;">&#39;s*&#39;</span> <span style="color: #e6edf3;">&rbrace;</span>       <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;Case insensitive&quot;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #ff7b72;">break</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="378">  <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #79c0ff;">$_</span> <span style="color: #79c0ff;">-clike</span> <span style="color: #a5d6ff;">&#39;s*&#39;</span><span style="color: #e6edf3;">&rbrace;</span>       <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;clike, ceq, cne for case sensitive&quot;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #ff7b72;">break</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="379">  <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #79c0ff;">$_</span> <span style="color: #79c0ff;">-notmatch</span> <span style="color: #a5d6ff;">&#39;^.*$&#39;</span><span style="color: #e6edf3;">&rbrace;</span>  <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #ff7b72;">break</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="380">  default                 <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;Others&quot;</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="381"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="382">
</span><span class="line" data-line="383"><span style="color: #8b949e;"># Handle exceptions with a try/catch block</span>
</span><span class="line" data-line="384"><span style="color: #79c0ff;">try</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="385">    <span style="color: #8b949e;"># Use &quot;throw&quot; to raise an error</span>
</span><span class="line" data-line="386">    <span style="color: #79c0ff;">throw</span> <span style="color: #a5d6ff;">&quot;This is an error&quot;</span>
</span><span class="line" data-line="387"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="388"><span style="color: #79c0ff;">catch</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="389">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$Error</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">ExceptionMessage</span>
</span><span class="line" data-line="390"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="391"><span style="color: #79c0ff;">finally</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="392">    <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;We can clean up resources here&quot;</span>
</span><span class="line" data-line="393"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="394">
</span><span class="line" data-line="395">
</span><span class="line" data-line="396"><span style="color: #8b949e;"># Writing to a file</span>
</span><span class="line" data-line="397"><span style="color: #e6edf3;">$contents</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span><span style="color: #79c0ff;"><span style="color: #a5d6ff;">&quot;aa&quot;</span></span><span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">12</span> 
</span><span class="line" data-line="398">             <span style="color: #79c0ff;"><span style="color: #a5d6ff;">&quot;bb&quot;</span></span><span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">21</span><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="399"><span style="color: #e6edf3;">$contents</span> <span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Export-CSV</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #79c0ff;">$env:HOMEDRIVE</span>\file.csv&quot;</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># writes to a file</span>
</span><span class="line" data-line="400">
</span><span class="line" data-line="401"><span style="color: #e6edf3;">$contents</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;test string here&quot;</span>
</span><span class="line" data-line="402"><span style="color: #e6edf3;">$contents</span> <span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Out-File</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #79c0ff;">$env:HOMEDRIVE</span>\file.txt&quot;</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># writes to another file</span>
</span><span class="line" data-line="403">
</span><span class="line" data-line="404"><span style="color: #8b949e;"># Read file contents and convert to json</span>
</span><span class="line" data-line="405"><span style="color: #d2a8ff;">Get-Content</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;<span style="color: #79c0ff;">$env:HOMEDRIVE</span>\file.csv&quot;</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">ConvertTo-Json</span>
</span><span class="line" data-line="406">
</span><span class="line" data-line="407">
</span><span class="line" data-line="408"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="409"><span style="color: #8b949e;">## 4. Functions</span>
</span><span class="line" data-line="410"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="411">
</span><span class="line" data-line="412"><span style="color: #8b949e;"># Use &quot;function&quot; to create new functions</span>
</span><span class="line" data-line="413"><span style="color: #8b949e;"># Keep the Verb-Noun naming convention for functions</span>
</span><span class="line" data-line="414"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">Add-Numbers</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="415"> <span style="color: #79c0ff;">$args</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">]</span> <span style="color: #79c0ff;">+</span> <span style="color: #79c0ff;">$args</span><span style="color: #e6edf3;">[</span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="416"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="417">
</span><span class="line" data-line="418"><span style="color: #d2a8ff;">Add-Numbers</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># =&gt; 3</span>
</span><span class="line" data-line="419">
</span><span class="line" data-line="420"><span style="color: #8b949e;"># Calling functions with parameters</span>
</span><span class="line" data-line="421"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">Add-ParamNumbers</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="422"> <span style="color: #ff7b72;">param</span><span style="color: #e6edf3;">(</span> <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$firstNumber</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$secondNumber</span> <span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="423"> <span style="color: #e6edf3;">$firstNumber</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">$secondNumber</span>
</span><span class="line" data-line="424"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="425">
</span><span class="line" data-line="426"><span style="color: #d2a8ff;">Add-ParamNumbers</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-FirstNumber</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">1</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-SecondNumber</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># =&gt; 3 </span>
</span><span class="line" data-line="427">
</span><span class="line" data-line="428"><span style="color: #8b949e;"># Functions with named parameters, parameter attributes, parsable documentation</span>
</span><span class="line" data-line="429"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="430"><span style="color: #8b949e;">.SYNOPSIS</span>
</span><span class="line" data-line="431"><span style="color: #8b949e;">Setup a new website</span>
</span><span class="line" data-line="432"><span style="color: #8b949e;">.DESCRIPTION</span>
</span><span class="line" data-line="433"><span style="color: #8b949e;">Creates everything your new website needs for much win</span>
</span><span class="line" data-line="434"><span style="color: #8b949e;">.PARAMETER siteName</span>
</span><span class="line" data-line="435"><span style="color: #8b949e;">The name for the new website</span>
</span><span class="line" data-line="436"><span style="color: #8b949e;">.EXAMPLE</span>
</span><span class="line" data-line="437"><span style="color: #8b949e;">New-Website -Name FancySite -Po 5000</span>
</span><span class="line" data-line="438"><span style="color: #8b949e;">New-Website SiteWithDefaultPort</span>
</span><span class="line" data-line="439"><span style="color: #8b949e;">New-Website siteName 2000 # <span style="color: #30363d; background-color: #f85149;">ERROR</span>! Port argument could not be validated</span>
</span><span class="line" data-line="440"><span style="color: #8b949e;">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span>
</span><span class="line" data-line="441"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="442"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">New-Website</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="443">    <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">CmdletBinding</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="444">    <span style="color: #ff7b72;">param</span> <span style="color: #e6edf3;">(</span>
</span><span class="line" data-line="445">        <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">Parameter</span><span style="color: #e6edf3;">(</span>ValueFromPipeline<span style="color: #79c0ff;">=</span><span style="color: #79c0ff;">$true</span><span style="color: #e6edf3;">,</span> Mandatory<span style="color: #79c0ff;">=</span><span style="color: #79c0ff;">$true</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="446">        <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">Alias</span><span style="color: #e6edf3;">(</span><span style="color: #a5d6ff;">&#39;name&#39;</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="447">        <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$siteName</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="448">        <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">ValidateSet</span><span style="color: #e6edf3;">(</span><span style="color: #79c0ff;">3000</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">5000</span><span style="color: #e6edf3;">,</span><span style="color: #79c0ff;">8000</span><span style="color: #e6edf3;">)</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="449">        <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">int</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$port</span> <span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">3000</span>
</span><span class="line" data-line="450">    <span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="451">    <span style="color: #ff7b72;">BEGIN</span> <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39;Creating new website(s)&#39;</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="452">    <span style="color: #ff7b72;">PROCESS</span> <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&quot;name: <span style="color: #e6edf3;">$siteName</span>, port: <span style="color: #e6edf3;">$port</span>&quot;</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="453">    <span style="color: #ff7b72;">END</span> <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39;Website(s) created&#39;</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="454"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="455">
</span><span class="line" data-line="456">
</span><span class="line" data-line="457"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="458"><span style="color: #8b949e;">## 5. Modules</span>
</span><span class="line" data-line="459"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="460">
</span><span class="line" data-line="461"><span style="color: #8b949e;"># You can import modules and install modules</span>
</span><span class="line" data-line="462"><span style="color: #8b949e;"># The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span>
</span><span class="line" data-line="463"><span style="color: #d2a8ff;">Install-Module</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">dbaTools</span>
</span><span class="line" data-line="464"><span style="color: #d2a8ff;">Import-Module</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">dbaTools</span>
</span><span class="line" data-line="465">
</span><span class="line" data-line="466"><span style="color: #e6edf3;">$query</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;SELECT * FROM dbo.sometable&quot;</span>
</span><span class="line" data-line="467"><span style="color: #e6edf3;">$queryParams</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span>
</span><span class="line" data-line="468">    <span style="color: #79c0ff;">SqlInstance</span> <span style="color: #79c0ff;">=</span> <span style="color: #a5d6ff;">&#39;testInstance&#39;</span>
</span><span class="line" data-line="469">    <span style="color: #79c0ff;">Database</span>    <span style="color: #79c0ff;">=</span> <span style="color: #a5d6ff;">&#39;testDatabase&#39;</span>
</span><span class="line" data-line="470">    <span style="color: #79c0ff;">Query</span>       <span style="color: #79c0ff;">=</span> <span style="color: #e6edf3;">$query</span>
</span><span class="line" data-line="471"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="472"><span style="color: #d2a8ff;">Invoke-DbaQuery</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">@queryParams</span>
</span><span class="line" data-line="473">
</span><span class="line" data-line="474"><span style="color: #8b949e;"># You can get specific functions from a module</span>
</span><span class="line" data-line="475"><span style="color: #d2a8ff;">Import-Module</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-Function</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">Invoke-DbaQuery</span>
</span><span class="line" data-line="476">
</span><span class="line" data-line="477">
</span><span class="line" data-line="478"><span style="color: #8b949e;"># Powershell modules are just ordinary Posh files. You</span>
</span><span class="line" data-line="479"><span style="color: #8b949e;"># can write your own, and import them. The name of the</span>
</span><span class="line" data-line="480"><span style="color: #8b949e;"># module is the same as the name of the file.</span>
</span><span class="line" data-line="481">
</span><span class="line" data-line="482"><span style="color: #8b949e;"># You can find out which functions and attributes</span>
</span><span class="line" data-line="483"><span style="color: #8b949e;"># are defined in a module.</span>
</span><span class="line" data-line="484"><span style="color: #d2a8ff;">Get-Command</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-module</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">dbaTools</span>
</span><span class="line" data-line="485"><span style="color: #d2a8ff;">Get-Help</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">dbaTools</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-Full</span>
</span><span class="line" data-line="486">
</span><span class="line" data-line="487">
</span><span class="line" data-line="488"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="489"><span style="color: #8b949e;">## 6. Classes</span>
</span><span class="line" data-line="490"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="491">
</span><span class="line" data-line="492"><span style="color: #8b949e;"># We use the &quot;class&quot; statement to create a class</span>
</span><span class="line" data-line="493"><span style="color: #ff7b72;">class</span> <span style="color: #ffa657;">Instrument</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="494">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$Type</span>
</span><span class="line" data-line="495">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$Family</span>
</span><span class="line" data-line="496"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="497">
</span><span class="line" data-line="498"><span style="color: #e6edf3;">$instrument</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">Instrument</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #ffa657;">new</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="499"><span style="color: #e6edf3;">$instrument</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Type</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;String Instrument&quot;</span>
</span><span class="line" data-line="500"><span style="color: #e6edf3;">$instrument</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Family</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;Plucked String&quot;</span>
</span><span class="line" data-line="501">
</span><span class="line" data-line="502"><span style="color: #e6edf3;">$instrument</span>
</span><span class="line" data-line="503">
</span><span class="line" data-line="504"><span style="color: #8b949e;">&lt;# Output:</span>
</span><span class="line" data-line="505"><span style="color: #8b949e;">Type              Family        </span>
</span><span class="line" data-line="506"><span style="color: #8b949e;">----              ------        </span>
</span><span class="line" data-line="507"><span style="color: #8b949e;">String Instrument Plucked String</span>
</span><span class="line" data-line="508"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="509">
</span><span class="line" data-line="510">
</span><span class="line" data-line="511"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="512"><span style="color: #8b949e;">## 6.1 Inheritance</span>
</span><span class="line" data-line="513"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="514">
</span><span class="line" data-line="515"><span style="color: #8b949e;"># Inheritance allows new child classes to be defined that inherit </span>
</span><span class="line" data-line="516"><span style="color: #8b949e;"># methods and variables from their parent class.</span>
</span><span class="line" data-line="517">
</span><span class="line" data-line="518"><span style="color: #ff7b72;">class</span> <span style="color: #ffa657;">Guitar</span> : <span style="color: #ffa657;">Instrument</span>
</span><span class="line" data-line="519"><span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="520">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$Brand</span>
</span><span class="line" data-line="521">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$SubType</span>
</span><span class="line" data-line="522">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$ModelType</span>
</span><span class="line" data-line="523">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">string</span><span style="color: #e6edf3;">]</span><span style="color: #79c0ff;">$ModelNumber</span>
</span><span class="line" data-line="524"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="525">
</span><span class="line" data-line="526"><span style="color: #e6edf3;">$myGuitar</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">Guitar</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #ffa657;">new</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="527"><span style="color: #e6edf3;">$myGuitar</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Brand</span>       <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;Taylor&quot;</span>
</span><span class="line" data-line="528"><span style="color: #e6edf3;">$myGuitar</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">SubType</span>     <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;Acoustic&quot;</span>
</span><span class="line" data-line="529"><span style="color: #e6edf3;">$myGuitar</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">ModelType</span>   <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;Presentation&quot;</span>
</span><span class="line" data-line="530"><span style="color: #e6edf3;">$myGuitar</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">ModelNumber</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&quot;PS14ce Blackwood&quot;</span>
</span><span class="line" data-line="531">
</span><span class="line" data-line="532"><span style="color: #e6edf3;">$myGuitar</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">GetType</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="533">
</span><span class="line" data-line="534"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="535"><span style="color: #8b949e;">IsPublic IsSerial Name                                     BaseType                                               </span>
</span><span class="line" data-line="536"><span style="color: #8b949e;">-------- -------- ----                                     --------                                               </span>
</span><span class="line" data-line="537"><span style="color: #8b949e;">True     False    Guitar                                   Instrument  </span>
</span><span class="line" data-line="538"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="539">
</span><span class="line" data-line="540">
</span><span class="line" data-line="541"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="542"><span style="color: #8b949e;">## 7. Advanced</span>
</span><span class="line" data-line="543"><span style="color: #8b949e;">####################################################</span>
</span><span class="line" data-line="544">
</span><span class="line" data-line="545"><span style="color: #8b949e;"># The powershell pipeline allows things like High-Order Functions.</span>
</span><span class="line" data-line="546">
</span><span class="line" data-line="547"><span style="color: #8b949e;"># Group-Object is a handy cmdlet that does incredible things.</span>
</span><span class="line" data-line="548"><span style="color: #8b949e;"># It works much like a GROUP BY in SQL.</span>
</span><span class="line" data-line="549">
</span><span class="line" data-line="550"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="551"><span style="color: #8b949e;"> The following will get all the running processes,</span>
</span><span class="line" data-line="552"><span style="color: #8b949e;"> group them by Name,</span>
</span><span class="line" data-line="553"><span style="color: #8b949e;"> and tell us how many instances of each process we have running.</span>
</span><span class="line" data-line="554"><span style="color: #8b949e;"> Tip: Chrome and svcHost are usually big numbers in this regard.</span>
</span><span class="line" data-line="555"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="556"><span style="color: #d2a8ff;">Get-Process</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> Foreach-Object <span style="color: #ff7b72;">Process</span>Name <span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Group-Object</span>
</span><span class="line" data-line="557">
</span><span class="line" data-line="558"><span style="color: #8b949e;"># Useful pipeline examples are iteration and filtering.</span>
</span><span class="line" data-line="559"><span style="color: #d2a8ff;">1..10</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> ForEach-Object <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #a5d6ff;">&quot;Loop number <span style="color: #e6edf3;">$PSITEM</span>&quot;</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="560"><span style="color: #d2a8ff;">1..10</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Where-Object</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">&lbrace;</span> <span style="color: #e6edf3;">$PSITEM</span> <span style="color: #79c0ff;">-gt</span> <span style="color: #79c0ff;">5</span> <span style="color: #e6edf3;">&rbrace;</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">ConvertTo-Json</span>
</span><span class="line" data-line="561">
</span><span class="line" data-line="562"><span style="color: #8b949e;"># A notable pitfall of the pipeline is its performance when</span>
</span><span class="line" data-line="563"><span style="color: #8b949e;"># compared with other options.</span>
</span><span class="line" data-line="564"><span style="color: #8b949e;"># Additionally, raw bytes are not passed through the pipeline,</span>
</span><span class="line" data-line="565"><span style="color: #8b949e;"># so passing an image causes some issues.</span>
</span><span class="line" data-line="566"><span style="color: #8b949e;"># See more on that in the link at the bottom.</span>
</span><span class="line" data-line="567">
</span><span class="line" data-line="568"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="569"><span style="color: #8b949e;"> Asynchronous functions exist in the form of jobs.</span>
</span><span class="line" data-line="570"><span style="color: #8b949e;"> Typically a procedural language,</span>
</span><span class="line" data-line="571"><span style="color: #8b949e;"> Powershell can operate non-blocking functions when invoked as Jobs.</span>
</span><span class="line" data-line="572"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="573">
</span><span class="line" data-line="574"><span style="color: #8b949e;"># This function is known to be non-optimized, and therefore slow.</span>
</span><span class="line" data-line="575"><span style="color: #e6edf3;">$installedApps</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #d2a8ff;">Get-CimInstance</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-ClassName</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">Win32_Product</span>
</span><span class="line" data-line="576">
</span><span class="line" data-line="577"><span style="color: #8b949e;"># If we had a script, it would hang at this func for a period of time.</span>
</span><span class="line" data-line="578"><span style="color: #e6edf3;">$scriptBlock</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">&lbrace;</span><span style="color: #d2a8ff;">Get-CimInstance</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-ClassName</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">Win32_Product</span><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="579"><span style="color: #d2a8ff;">Start-Job</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-ScriptBlock</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">$scriptBlock</span>
</span><span class="line" data-line="580">
</span><span class="line" data-line="581"><span style="color: #8b949e;"># This will start a background job that runs the command.</span>
</span><span class="line" data-line="582"><span style="color: #8b949e;"># You can then obtain the status of jobs and their returned results.</span>
</span><span class="line" data-line="583"><span style="color: #e6edf3;">$allJobs</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #d2a8ff;">Get-Job</span>
</span><span class="line" data-line="584"><span style="color: #e6edf3;">$jobResponse</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #d2a8ff;">Get-Job</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Receive-Job</span>
</span><span class="line" data-line="585">
</span><span class="line" data-line="586">
</span><span class="line" data-line="587"><span style="color: #8b949e;"># Math is built in to powershell and has many functions.</span>
</span><span class="line" data-line="588"><span style="color: #e6edf3;">$r</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">2</span>
</span><span class="line" data-line="589"><span style="color: #e6edf3;">$pi</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #e6edf3;">[</span><span style="color: #ffa657;">math</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #79c0ff;">pi</span>
</span><span class="line" data-line="590"><span style="color: #e6edf3;">$r2</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #e6edf3;">[</span><span style="color: #ffa657;">math</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">::</span><span style="color: #d2a8ff;">pow</span><span style="color: #e6edf3;">(</span> <span style="color: #e6edf3;">$r</span><span style="color: #e6edf3;">,</span> <span style="color: #79c0ff;">2</span> <span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="591"><span style="color: #e6edf3;">$area</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$pi</span><span style="color: #79c0ff;">*</span><span style="color: #e6edf3;">$r2</span>
</span><span class="line" data-line="592"><span style="color: #e6edf3;">$area</span>
</span><span class="line" data-line="593">
</span><span class="line" data-line="594"><span style="color: #8b949e;"># To see all possibilities, check the members.</span>
</span><span class="line" data-line="595"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Math</span><span style="color: #e6edf3;">]</span> <span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Get-Member</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-Static</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-MemberType</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">All</span>
</span><span class="line" data-line="596">
</span><span class="line" data-line="597">
</span><span class="line" data-line="598"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="599"><span style="color: #8b949e;"> This is a silly one:</span>
</span><span class="line" data-line="600"><span style="color: #8b949e;"> You may one day be asked to create a func that could take $start and $end</span>
</span><span class="line" data-line="601"><span style="color: #8b949e;"> and reverse anything in an array within the given range</span>
</span><span class="line" data-line="602"><span style="color: #8b949e;"> based on an arbitrary array without mutating the original array.</span>
</span><span class="line" data-line="603"><span style="color: #8b949e;"> Let&#39;s see one way to do that and introduce another data structure.</span>
</span><span class="line" data-line="604"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="605">
</span><span class="line" data-line="606"><span style="color: #e6edf3;">$targetArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #a5d6ff;">&#39;a&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;b&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;c&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;d&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;e&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;f&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;g&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;h&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;i&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;j&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;k&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;l&#39;</span><span style="color: #e6edf3;">,</span><span style="color: #a5d6ff;">&#39;m&#39;</span>
</span><span class="line" data-line="607">
</span><span class="line" data-line="608"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">Format-Range</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$start</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="609">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>ArrayList</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$firstSectionArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="610">    <span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>ArrayList</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$secondSectionArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="611">    <span style="color: #e6edf3;">[</span><span style="color: #ffa657;">System<span style="color: #e6edf3;">.</span>Collections<span style="color: #e6edf3;">.</span>Stack</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$stack</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="612">    <span style="color: #ff7b72;">for</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$index</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">0</span><span style="color: #e6edf3;">;</span> <span style="color: #e6edf3;">$index</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">.</span><span style="color: #79c0ff;">Count</span><span style="color: #e6edf3;">;</span> <span style="color: #79c0ff;"><span style="color: #e6edf3;">$index</span>++</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="613">        <span style="color: #ff7b72;">if</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$index</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #e6edf3;">$start</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="614">            <span style="color: #e6edf3;">$firstSectionArray</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$index</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>
</span><span class="line" data-line="615">        <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="616">        <span style="color: #ff7b72;">elseif</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$index</span> <span style="color: #79c0ff;">-ge</span> <span style="color: #e6edf3;">$start</span> <span style="color: #79c0ff;">-and</span> <span style="color: #e6edf3;">$index</span> <span style="color: #79c0ff;">-le</span> <span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="617">            <span style="color: #e6edf3;">$stack</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Push</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$index</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="618">        <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="619">        <span style="color: #ff7b72;">else</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="620">            <span style="color: #e6edf3;">$secondSectionArray</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">Add</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$array</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$index</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">)</span> &gt;<span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">$null</span>
</span><span class="line" data-line="621">        <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="622">    <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="623">    <span style="color: #e6edf3;">$finalArray</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$firstSectionArray</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">$stack</span><span style="color: #e6edf3;">.</span><span style="color: #d2a8ff;">ToArray</span><span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">)</span> <span style="color: #79c0ff;">+</span> <span style="color: #e6edf3;">$secondSectionArray</span>
</span><span class="line" data-line="624">    <span style="color: #ff7b72;">return</span> <span style="color: #e6edf3;">$finalArray</span>
</span><span class="line" data-line="625"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="626">
</span><span class="line" data-line="627"><span style="color: #ff7b72;">For</span>mat<span style="color: #79c0ff;">-Range</span> 2 6 <span style="color: #e6edf3;">$targetArray</span> 
</span><span class="line" data-line="628"><span style="color: #8b949e;"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>
</span><span class="line" data-line="629">
</span><span class="line" data-line="630"><span style="color: #8b949e;"># The previous method works, but uses extra memory by allocating new arrays.</span>
</span><span class="line" data-line="631"><span style="color: #8b949e;"># It&#39;s also kind of lengthy.</span>
</span><span class="line" data-line="632"><span style="color: #8b949e;"># Let&#39;s see how we can do this without allocating a new array.</span>
</span><span class="line" data-line="633"><span style="color: #8b949e;"># This is slightly faster as well.</span>
</span><span class="line" data-line="634">
</span><span class="line" data-line="635"><span style="color: #ff7b72;">function</span> <span style="color: #d2a8ff;">Format-Range</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$start</span><span style="color: #e6edf3;">,</span> <span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="636">  <span style="color: #ff7b72;">while</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$start</span> <span style="color: #79c0ff;">-lt</span> <span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="637">  <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="638">      <span style="color: #e6edf3;">$temp</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$targetArray</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$start</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="639">      <span style="color: #e6edf3;">$targetArray</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$start</span><span style="color: #e6edf3;">]</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$targetArray</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">]</span>
</span><span class="line" data-line="640">      <span style="color: #e6edf3;">$targetArray</span><span style="color: #e6edf3;">[</span><span style="color: #e6edf3;">$end</span><span style="color: #e6edf3;">]</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">$temp</span>
</span><span class="line" data-line="641">      <span style="color: #79c0ff;"><span style="color: #e6edf3;">$start</span>++</span>
</span><span class="line" data-line="642">      <span style="color: #79c0ff;"><span style="color: #e6edf3;">$end</span>--</span>
</span><span class="line" data-line="643">  <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="644">  <span style="color: #ff7b72;">return</span> <span style="color: #e6edf3;">$targetArray</span>
</span><span class="line" data-line="645"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="646">
</span><span class="line" data-line="647"><span style="color: #ff7b72;">For</span>mat<span style="color: #79c0ff;">-Range</span> 2 6<span style="color: #8b949e;"> # =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>
</span><span class="line" data-line="648">```
</span><span class="line" data-line="649">
</span><span class="line" data-line="650">Powershell as a Tool:
</span><span class="line" data-line="651">
</span><span class="line" data-line="652">Getting Help:
</span><span class="line" data-line="653">
</span><span class="line" data-line="654">```powershell<span style="color: #8b949e;"></span>
</span><span class="line" data-line="655"><span style="color: #8b949e;"># Find commands</span>
</span><span class="line" data-line="656">Get<span style="color: #79c0ff;">-Command</span> about_<span style="color: #79c0ff;">*</span><span style="color: #8b949e;"> # alias: gcm</span>
</span><span class="line" data-line="657">Get<span style="color: #79c0ff;">-Command</span><span style="color: #79c0ff;"> -Verb</span> Add
</span><span class="line" data-line="658">Get<span style="color: #79c0ff;">-Alias</span> ps
</span><span class="line" data-line="659">Get<span style="color: #79c0ff;">-Alias</span><span style="color: #79c0ff;"> -Definition</span> Get<span style="color: #79c0ff;">-Process</span>
</span><span class="line" data-line="660">
</span><span class="line" data-line="661">Get<span style="color: #79c0ff;">-Help</span> ps<span style="color: #79c0ff;"> |</span> less<span style="color: #8b949e;"> # alias: help</span>
</span><span class="line" data-line="662">ps<span style="color: #79c0ff;"> |</span> Get<span style="color: #79c0ff;">-Member</span><span style="color: #8b949e;"> # alias: gm</span>
</span><span class="line" data-line="663">
</span><span class="line" data-line="664">Show<span style="color: #79c0ff;">-Command</span> Get<span style="color: #79c0ff;">-WinEvent</span><span style="color: #8b949e;"> # Display GUI to fill in the parameters</span>
</span><span class="line" data-line="665">
</span><span class="line" data-line="666">Update<span style="color: #79c0ff;">-Help</span><span style="color: #8b949e;"> # Run as admin</span>
</span><span class="line" data-line="667">```
</span><span class="line" data-line="668">
</span><span class="line" data-line="669"><span style="color: #ff7b72;">If</span> you are uncertain about your environment:
</span><span class="line" data-line="670">
</span><span class="line" data-line="671">```powershell
</span><span class="line" data-line="672">Get<span style="color: #79c0ff;">-ExecutionPolicy</span><span style="color: #79c0ff;"> -List</span>
</span><span class="line" data-line="673">Set<span style="color: #79c0ff;">-ExecutionPolicy</span> AllSigned<span style="color: #8b949e;"></span>
</span><span class="line" data-line="674"><span style="color: #8b949e;"># Execution policies include:</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="675"><span style="color: #8b949e;"># - Restricted: Scripts won&#39;t run.</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="676"><span style="color: #8b949e;"># - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="677"><span style="color: #8b949e;"># - AllSigned: Scripts need to be signed by a trusted publisher.</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="678"><span style="color: #8b949e;"># - Unrestricted: Run all scripts.</span>
</span><span class="line" data-line="679">help about_Execution_Policies<span style="color: #8b949e;"> # for more info</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="680"><span style="color: #8b949e;"></span>
</span><span class="line" data-line="681"><span style="color: #8b949e;"># Current PowerShell version:</span>
</span><span class="line" data-line="682"><span style="color: #79c0ff;">$PSVersionTable</span>
</span><span class="line" data-line="683">```
</span><span class="line" data-line="684">
</span><span class="line" data-line="685">```powershell<span style="color: #8b949e;"></span>
</span><span class="line" data-line="686"><span style="color: #8b949e;"># Calling external commands, executables, </span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="687"><span style="color: #8b949e;"># and functions with the call operator.</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="688"><span style="color: #8b949e;"># Exe paths with arguments passed or containing spaces can create issues.</span>
</span><span class="line" data-line="689">C:<span style="color: #79c0ff;">\</span>Program Files<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #e6edf3;">.</span>exe<span style="color: #8b949e;"></span>
</span><span class="line" data-line="690"><span style="color: #8b949e;"># The term &#39;C:\Program&#39; is not recognized as a name of a cmdlet,</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="691"><span style="color: #8b949e;"># function, script file, or executable program.</span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="692"><span style="color: #8b949e;"># Check the spelling of the name, or if a path was included, </span><span style="color: #8b949e;"></span>
</span><span class="line" data-line="693"><span style="color: #8b949e;"># verify that the path is correct and try again</span>
</span><span class="line" data-line="694">
</span><span class="line" data-line="695">&quot;C:<span style="color: #79c0ff;">\</span>Program Files<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #e6edf3;">.</span>exe&quot;
</span><span class="line" data-line="696">C:<span style="color: #79c0ff;">\</span>Program Files<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #79c0ff;">\</span><span style="color: #ff7b72;">do</span>tnet<span style="color: #e6edf3;">.</span>exe<span style="color: #8b949e;">    # returns string rather than execute</span>
</span><span class="line" data-line="697">
</span><span class="line" data-line="698"><span style="color: #79c0ff;">&amp;</span><span style="color: #a5d6ff;">&quot;C:\Program Files\dotnet\dotnet.exe --help&quot;</span><span style="color: #e6edf3;">   </span><span style="color: #8b949e;"># fail</span>
</span><span class="line" data-line="699"><span style="color: #79c0ff;">&amp;</span><span style="color: #a5d6ff;">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">--help</span><span style="color: #e6edf3;">   </span><span style="color: #8b949e;"># success</span>
</span><span class="line" data-line="700"><span style="color: #8b949e;"># Alternatively, you can use dot-sourcing here</span>
</span><span class="line" data-line="701"><span style="color: #e6edf3;"><span style="color: #79c0ff;">.</span></span><span style="color: #a5d6ff;">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">--help</span><span style="color: #e6edf3;">   </span><span style="color: #8b949e;"># success</span>
</span><span class="line" data-line="702">
</span><span class="line" data-line="703"><span style="color: #8b949e;"># the call operator (&amp;) is similar to Invoke-Expression, </span>
</span><span class="line" data-line="704"><span style="color: #8b949e;"># but IEX runs in current scope.</span>
</span><span class="line" data-line="705"><span style="color: #8b949e;"># One usage of &#39;&amp;&#39; would be to invoke a scriptblock inside of your script.</span>
</span><span class="line" data-line="706"><span style="color: #8b949e;"># Notice the variables are scoped</span>
</span><span class="line" data-line="707"><span style="color: #e6edf3;">$i</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #79c0ff;">2</span>
</span><span class="line" data-line="708"><span style="color: #e6edf3;">$scriptBlock</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">&lbrace;</span> <span style="color: #e6edf3;">$i</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">5</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span> <span style="color: #d2a8ff;">Write-Output</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">$i</span> <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="709"><span style="color: #79c0ff;">&amp;</span> <span style="color: #e6edf3;">$scriptBlock</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># =&gt; 5</span>
</span><span class="line" data-line="710"><span style="color: #e6edf3;">$i</span> <span style="color: #8b949e;"># =&gt; 2</span>
</span><span class="line" data-line="711">
</span><span class="line" data-line="712"><span style="color: #d2a8ff;">invoke-expression</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39; $i=5; Write-Output $i &#39;</span><span style="color: #e6edf3;"> </span><span style="color: #8b949e;"># =&gt; 5</span>
</span><span class="line" data-line="713"><span style="color: #e6edf3;">$i</span> <span style="color: #8b949e;"># =&gt; 5</span>
</span><span class="line" data-line="714">
</span><span class="line" data-line="715"><span style="color: #8b949e;"># Alternatively, to preserve changes to public variables</span>
</span><span class="line" data-line="716"><span style="color: #8b949e;"># you can use &quot;Dot-Sourcing&quot;. This will run in the current scope.</span>
</span><span class="line" data-line="717"><span style="color: #e6edf3;">$x</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">1</span>
</span><span class="line" data-line="718"><span style="color: #79c0ff;">&amp;</span><span style="color: #e6edf3;">&lbrace;</span><span style="color: #e6edf3;">$x</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">&rbrace;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span><span style="color: #e6edf3;">$x</span> <span style="color: #8b949e;"># =&gt; 1</span>
</span><span class="line" data-line="719">
</span><span class="line" data-line="720"><span style="color: #e6edf3;"><span style="color: #79c0ff;">.</span></span><span style="color: #e6edf3;">&lbrace;</span><span style="color: #e6edf3;">$x</span><span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span><span style="color: #79c0ff;">2</span><span style="color: #e6edf3;">&rbrace;</span><span style="color: #e6edf3;"><span style="color: #e6edf3;">;</span></span><span style="color: #e6edf3;">$x</span> <span style="color: #8b949e;"># =&gt; 2</span>
</span><span class="line" data-line="721">
</span><span class="line" data-line="722">
</span><span class="line" data-line="723"><span style="color: #8b949e;"># Remoting into computers is easy.</span>
</span><span class="line" data-line="724"><span style="color: #d2a8ff;">Enter-PSSession</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-ComputerName</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">RemoteComputer</span>
</span><span class="line" data-line="725">
</span><span class="line" data-line="726"><span style="color: #8b949e;"># Once remoted in, you can run commands as if you&#39;re local.</span>
</span><span class="line" data-line="727"><span style="color: #d2a8ff;">RemoteComputer\PS&gt;</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">Get-Process</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">powershell</span>
</span><span class="line" data-line="728">
</span><span class="line" data-line="729"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="730"><span style="color: #8b949e;">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             </span>
</span><span class="line" data-line="731"><span style="color: #8b949e;">-------  ------    -----      -----     ------     --  -- -----------                                             </span>
</span><span class="line" data-line="732"><span style="color: #8b949e;">   1096      44   156324     179068      29.92  11772   1 powershell                                              </span>
</span><span class="line" data-line="733"><span style="color: #8b949e;">    545      25    49512      49852             25348   0 powershell </span>
</span><span class="line" data-line="734"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="735"><span style="color: #d2a8ff;">RemoteComputer\PS&gt;</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">Exit-PSSession</span>
</span><span class="line" data-line="736">
</span><span class="line" data-line="737"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="738"><span style="color: #8b949e;"> Powershell is an incredible tool for Windows management and Automation.</span>
</span><span class="line" data-line="739"><span style="color: #8b949e;"> Let&#39;s take the following scenario:</span>
</span><span class="line" data-line="740"><span style="color: #8b949e;"> You have 10 servers.</span>
</span><span class="line" data-line="741"><span style="color: #8b949e;"> You need to check whether a service is running on all of them.</span>
</span><span class="line" data-line="742"><span style="color: #8b949e;"> You can RDP and log in, or PSSession to all of them, but why?</span>
</span><span class="line" data-line="743"><span style="color: #8b949e;"> Check out the following</span>
</span><span class="line" data-line="744"><span style="color: #8b949e;">#&gt;</span>
</span><span class="line" data-line="745">
</span><span class="line" data-line="746"><span style="color: #e6edf3;">$serverList</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@(</span>
</span><span class="line" data-line="747">    <span style="color: #a5d6ff;">&#39;server1&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="748">    <span style="color: #a5d6ff;">&#39;server2&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="749">    <span style="color: #a5d6ff;">&#39;server3&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="750">    <span style="color: #a5d6ff;">&#39;server4&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="751">    <span style="color: #a5d6ff;">&#39;server5&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="752">    <span style="color: #a5d6ff;">&#39;server6&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="753">    <span style="color: #a5d6ff;">&#39;server7&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="754">    <span style="color: #a5d6ff;">&#39;server8&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="755">    <span style="color: #a5d6ff;">&#39;server9&#39;</span><span style="color: #e6edf3;">,</span>
</span><span class="line" data-line="756">    <span style="color: #a5d6ff;">&#39;server10&#39;</span>
</span><span class="line" data-line="757"><span style="color: #e6edf3;">)</span>
</span><span class="line" data-line="758">
</span><span class="line" data-line="759"><span style="color: #e6edf3;">[</span><span style="color: #ff7b72;">scriptblock</span><span style="color: #e6edf3;">]</span><span style="color: #e6edf3;">$script</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="760">    <span style="color: #d2a8ff;">Get-Service</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">-DisplayName</span><span style="color: #e6edf3;"> </span><span style="color: #a5d6ff;">&#39;Task Scheduler&#39;</span>
</span><span class="line" data-line="761"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="762">
</span><span class="line" data-line="763"><span style="color: #ff7b72;">foreach</span> <span style="color: #e6edf3;">(</span><span style="color: #e6edf3;">$server</span> <span style="color: #ff7b72;">in</span> <span style="color: #e6edf3;">$serverList</span><span style="color: #e6edf3;">)</span> <span style="color: #e6edf3;">&lbrace;</span>
</span><span class="line" data-line="764">    <span style="color: #e6edf3;">$cmdSplat</span> <span style="color: #79c0ff;"><span style="color: #79c0ff;">=</span></span> <span style="color: #e6edf3;">@&lbrace;</span>
</span><span class="line" data-line="765">        <span style="color: #79c0ff;">ComputerName</span>  <span style="color: #79c0ff;">=</span> <span style="color: #e6edf3;">$server</span>
</span><span class="line" data-line="766">        <span style="color: #79c0ff;">JobName</span>       <span style="color: #79c0ff;">=</span> <span style="color: #a5d6ff;">&#39;checkService&#39;</span>
</span><span class="line" data-line="767">        <span style="color: #79c0ff;">ScriptBlock</span>   <span style="color: #79c0ff;">=</span> <span style="color: #e6edf3;">$script</span>
</span><span class="line" data-line="768">        <span style="color: #79c0ff;">AsJob</span>         <span style="color: #79c0ff;">=</span> <span style="color: #79c0ff;">$true</span>
</span><span class="line" data-line="769">        <span style="color: #79c0ff;">ErrorAction</span>   <span style="color: #79c0ff;">=</span> <span style="color: #a5d6ff;">&#39;SilentlyContinue&#39;</span>
</span><span class="line" data-line="770">    <span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="771">    <span style="color: #d2a8ff;">Invoke-Command</span><span style="color: #e6edf3;"> </span><span style="color: #e6edf3;">@cmdSplat</span><span style="color: #e6edf3;"> </span><span style="color: #79c0ff;">|</span> <span style="color: #d2a8ff;">Out-Null</span>
</span><span class="line" data-line="772"><span style="color: #e6edf3;">&rbrace;</span>
</span><span class="line" data-line="773">
</span><span class="line" data-line="774"><span style="color: #8b949e;">&lt;#</span>
</span><span class="line" data-line="775"><span style="color: #8b949e;"> Here we&#39;ve invoked jobs across many servers.</span>
</span><span class="line" data-line="776"><span style="color: #8b949e;"> We can now Receive-Job and see if they&#39;re all running.</span>
</span><span class="line" data-line="777"><span style="color: #8b949e;"> Now scale this up 100x as many servers :)</span>
</span><span class="line" data-line="778"><span style="color: #8b949e;">#&gt;</span>
</span></code></pre>